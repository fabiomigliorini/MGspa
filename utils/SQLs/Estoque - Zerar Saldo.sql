--insert into tblestoquemovimento 
--	(codestoquemes, codestoquemovimentotipo, entradaquantidade, entradavalor, saidaquantidade, saidavalor, manual, data, criacao, codusuariocriacao, alteracao, codusuarioalteracao, observacoes)
select 
	mes.codestoquemes, 
	1002 as codestoquemovimentotipo,
	case when mes.saldoquantidade < 0 then abs(mes.saldoquantidade) else null end as entradaquantidade,
	case when mes.saldovalor < 0 then abs(mes.saldovalor) else null end as entradavalor,
	case when mes.saldoquantidade > 0 then abs(mes.saldoquantidade) else null end as saidaquantidade,
	case when mes.saldovalor > 0 then abs(mes.saldovalor) else null end as saidavalor,
	true as manual,
	(date_trunc('month', mes.mes) + interval '1 month' - interval '1 second') as data,
	date_trunc('second', now()) as criacao,
	1 as codusuariocriacao,
	date_trunc('second', now()) as alteracao,
	1 as codusuarioalteracao,
	'Zeramento automatico dos produtos inativos do estoque fiscal de dezembro de 2019.' as observacoes
from tblprodutovariacao pv 
inner join tblestoquelocalprodutovariacao elpv on (elpv.codprodutovariacao = pv.codprodutovariacao)
inner join tblestoquesaldo es on (es.codestoquelocalprodutovariacao = elpv.codestoquelocalprodutovariacao and es.fiscal = true)
inner join tblestoquemes mes on (mes.codestoquemes = (select iq.codestoquemes from tblestoquemes iq where iq.codestoquesaldo = es.codestoquesaldo and iq.mes <= '2019-12-31' order by iq.mes desc limit 1) )
where mes.saldoquantidade != 0
and pv.codproduto in (
	100789	,
	32595	,
	31417	,
	32595	,
	24972	,
	24972	,
	38173	,
	32189	,
	32173	,
	32734	,
	32736	,
	32733	,
	32731	,
	932660	,
	21912	,
	32303	,
	21929	,
	21929	,
	26706	,
	932645	,
	21926	,
	21926	,
	21916	,
	932965	,
	26294	,
	21107	,
	22620	,
	109166	,
	304617	,
	27091	,
	29258	,
	22182	,
	23328	,
	26405	,
	25953	,
	108814	,
	107891	,
	22689	,
	21280	,
	21280	,
	32737	,
	310414	,
	110857	,
	318933	,
	20493	,
	20584	,
	32043	,
	29209	,
	26358	,
	26358	,
	931400	,
	24538	,
	318785	,
	318785	,
	108941	,
	26413	,
	26413	,
	106229	,
	26633	,
	26633	,
	23403	,
	22616	,
	28991	,
	24434	,
	24434	,
	23630	,
	24252	,
	108992	,
	24438	,
	24438	,
	27650	,
	34571	,
	83	,
	23812	,
	24250	,
	27581	,
	27581	,
	27631	,
	23787	,
	313523	,
	27672	,
	23782	,
	933371	,
	24435	,
	27646	,
	22733	,
	27429	,
	23821	,
	23815	,
	23817	,
	23807	,
	27717	,
	110164	,
	110611	,
	110611	,
	16850	,
	16850	,
	23800	,
	23800	,
	23792	,
	23792	,
	28252	,
	28252	,
	23783	,
	23783	,
	7451	,
	23786	,
	34585	,
	34585	,
	313508	,
	23796	,
	23796	,
	313509	,
	27644	,
	933737	,
	933754	,
	313503	,
	313503	,
	27667	,
	23781	,
	303584	,
	17046	,
	100659	,
	23777	,
	4138	,
	110145	,
	110178	,
	2790	,
	313516	,
	313929	,
	313511	,
	7790	,
	7790	,
	34171	,
	23552	,
	27390	,
	27390	,
	23548	,
	23548	,
	23571	,
	23571	,
	27603	,
	27388	,
	23589	,
	23589	,
	317412	,
	317412	,
	933290	,
	933294	,
	933801	,
	23593	,
	23563	,
	7793	,
	27366	,
	933367	,
	933295	,
	103319	,
	27427	,
	34169	,
	27364	,
	106068	,
	2522	,
	23562	,
	933817	,
	27404	,
	27742	,
	23771	,
	23771	,
	27657	,
	29012	,
	23670	,
	108239	,
	28095	,
	25888	,
	27485	,
	27487	,
	23396	,
	24294	,
	23256	,
	109251	,
	109251	,
	12214	,
	12213	,
	109245	,
	27488	,
	26650	,
	23393	,
	317840	,
	23376	,
	23968	,
	23968	,
	28070	,
	23386	,
	23963	,
	23963	,
	2482	,
	933032	,
	932898	,
	23384	,
	23384	,
	19200	,
	19200	,
	314226	,
	313861	,
	306132	,
	18792	,
	306305	,
	26657	,
	306142	,
	306142	,
	4410	,
	23965	,
	5	,
	5	,
	310099	,
	29453	,
	313867	,
	23385	,
	27505	,
	27505	,
	314230	,
	314230	,
	302012	,
	302012	,
	101301	,
	16806	,
	306006	,
	21907	,
	956	,
	956	,
	23073	,
	958	,
	8195	,
	306306	,
	306306	,
	23071	,
	23071	,
	23070	,
	23970	,
	29462	,
	105805	,
	105805	,
	105805	,
	27859	,
	24293	,
	24293	,
	23966	,
	306012	,
	26653	,
	26653	,
	26658	,
	313866	,
	310088	,
	31001	,
	21904	,
	17305	,
	932901	,
	23967	,
	32591	,
	28067	,
	23958	,
	28066	,
	27866	,
	23382	,
	23382	,
	23390	,
	26652	,
	109205	,
	17039	,
	23959	,
	30457	,
	27583	,
	27588	,
	27870	,
	27870	,
	28399	,
	28400	,
	28401	,
	28401	,
	28402	,
	25887	,
	25887	,
	932897	,
	23394	,
	23394	,
	23394	,
	304741	,
	304741	,
	304741	,
	109222	,
	19195	,
	17306	,
	17306	,
	27868	,
	27871	,
	932416	,
	26640	,
	8612	,
	32805	,
	32805	,
	33439	,
	306009	,
	33899	,
	25332	,
	27079	,
	26971	,
	20502	,
	25235	,
	37209	,
	20924	,
	21932	,
	21933	,
	25355	,
	28176	,
	932966	,
	35000	,
	23664	,
	26411	,
	26410	,
	316902	,
	109454	,
	25226	,
	23462	,
	28167	,
	32066	,
	32066	,
	101164	,
	100675	,
	108513	,
	33897	,
	33895	,
	27010	,
	27015	,
	27012	,
	33537	,
	22175	,
	24918	,
	24921	,
	25017	,
	28219	,
	28219	,
	933340	,
	319028	,
	22608	,
	20506	,
	36997	,
	28742	,
	930987	,
	23334	,
	23334	,
	20605	,
	16555	,
	23406	,
	930997	,
	24043	,
	29259	,
	25010	,
	30196	,
	932222	,
	33603	,
	33603	,
	28118	,
	101762	,
	101894	,
	101779	,
	101713	,
	101718	,
	101891	,
	101865	,
	101867	,
	101861	,
	101882	,
	101814	,
	101816	,
	101815	,
	101815	,
	101904	,
	101810	,
	101842	,
	101748	,
	101785	,
	101892	,
	101751	,
	101745	,
	101733	,
	101813	,
	101717	,
	30768	,
	21143	,
	32000	,
	32000	,
	20046	,
	23488	,
	23488	,
	23487	,
	28171	,
	933142	,
	314297	,
	20818	,
	314428	,
	25381	,
	25381	,
	1021	,
	1021	,
	21778	,
	300299	,
	15026	,
	33527	,
	24919	,
	22597	,
	22597	,
	22597	,
	22593	,
	22677	,
	22596	,
	312291	,
	312291	,
	32003	,
	20606	,
	21813	,
	21814	,
	21814	,
	110761	,
	110761	,
	25241	,
	25241	,
	36998	,
	316269	,
	101932	,
	25243	,
	106734	,
	201481	,
	22335	,
	22333	,
	319085	,
	20618	,
	25529	,
	31795	,
	22122	,
	24941	,
	21673	,
	931709	,
	201641	,
	24915	,
	28172	,
	110308	,
	315661	,
	22717	,
	4070	,
	306202	,
	107288	,
	33737	,
	24449	,
	19893	,
	33712	,
	20022	,
	20024	,
	33717	,
	34416	,
	31577	,
	31577	,
	31573	,
	27985	,
	27985	,
	31580	,
	31580	,
	932630	,
	932630	,
	24031	,
	24032	,
	24028	,
	21637	,
	21642	,
	24037	,
	109385	,
	319272	,
	108384	,
	29223	,
	315263	,
	28097	,
	28102	,
	109972	,
	24912	,
	23457	,
	30263	,
	30262	,
	933049	,
	26376	,
	110829	,
	110571	,
	23653	,
	23653	,
	9951	,
	9951	,
	932497	,
	102108	,
	3566	,
	27086	,
	24835	,
	931206	,
	21263	,
	5980	,
	32678	,
	21350	,
	24940	,
	18737	,
	29333	,
	930735	,
	930735	,
	31981	,
	20583	,
	106760	,
	23473	,
	23468	,
	23468	,
	23464	,
	23464	,
	22099	,
	22097	,
	22098	,
	933157	,
	26980	,
	22592	,
	22601	,
	22601	,
	22599	,
	24495	,
	20543	,
	103741	,
	27020	,
	7725	,
	26418	,
	25962	,
	25962	,
	29528	,
	29528	,
	29529	,
	25951	,
	109841	,
	430	,
	22467	,
	20088	,
	25150	,
	30614	,
	109974	,
	18097	,
	22956	,
	933601	,
	933601	,
	33501	,
	22172	,
	106594	,
	316384	,
	316384	,
	109975	,
	22363	,
	22363	,
	20715	,
	932230	,
	23269	,
	28109	,
	28109	,
	25588	,
	28521	,
	108471	,
	313387	,
	103845	,
	23153	,
	28481	,
	22955	,
	33833	,
	104221	,
	26417	,
	8884	,
	933200	,
	33500	,
	933798	,
	27006	,
	21117	,
	12460	,
	24717	,
	32110	,
	21114	,
	24493	,
	24494	,
	25952	,
	25953	,
	21494	,
	22607	,
	22689	,
	931207	,
	318785	,
	108941	,
	29207	,
	26633	,
	23403	,
	23819	,
	933579	,
	23630	,
	19900	,
	19224	,
	23812	,
	23812	,
	32251	,
	23787	,
	933765	,
	933822	,
	23821	,
	34451	,
	34451	,
	27733	,
	27733	,
	27717	,
	23808	,
	314254	,
	27627	,
	29191	,
	933710	,
	313512	,
	23783	,
	27740	,
	313508	,
	313536	,
	110134	,
	933714	,
	933497	,
	23774	,
	933759	,
	313510	,
	19803	,
	313935	,
	933734	,
	313929	,
	933494	,
	23552	,
	23572	,
	27388	,
	7803	,
	23577	,
	27619	,
	933290	,
	933801	,
	23565	,
	23593	,
	27386	,
	933833	,
	23563	,
	7793	,
	933831	,
	933367	,
	34169	,
	311183	,
	23587	,
	27404	,
	933807	,
	28435	,
	20270	,
	23668	,
	23668	,
	23961	,
	24294	,
	23256	,
	23391	,
	314227	,
	23373	,
	12213	,
	4386	,
	105798	,
	109245	,
	310085	,
	310095	,
	23968	,
	933032	,
	933032	,
	2	,
	314226	,
	19215	,
	18792	,
	306305	,
	23964	,
	109132	,
	306134	,
	16806	,
	16806	,
	26636	,
	26636	,
	23257	,
	21907	,
	21907	,
	956	,
	8195	,
	8195	,
	23071	,
	109191	,
	29463	,
	34653	,
	21904	,
	310098	,
	28374	,
	4839	,
	7962	,
	17137	,
	4840	,
	27867	,
	29464	,
	109217	,
	28400	,
	932897	,
	26639	,
	26639	,
	109222	,
	109258	,
	27868	,
	318002	,
	25332	,
	27084	,
	20502	,
	25235	,
	31820	,
	31820	,
	26410	,
	32078	,
	20747	,
	23462	,
	28167	,
	25948	,
	24951	,
	100059	,
	25335	,
	25335	,
	24492	,
	102387	,
	25245	,
	25245	,
	24879	,
	20579	,
	933349	,
	26139	,
	20605	,
	23348	,
	31289	,
	28103	,
	930997	,
	26407	,
	101811	,
	101720	,
	101736	,
	101739	,
	101814	,
	101816	,
	101801	,
	101852	,
	101904	,
	101714	,
	101751	,
	101732	,
	101838	,
	101783	,
	101750	,
	101809	,
	28171	,
	933142	,
	16561	,
	20818	,
	200416	,
	200416	,
	21778	,
	21778	,
	312291	,
	32003	,
	106739	,
	21814	,
	930710	,
	25060	,
	25060	,
	30569	,
	31754	,
	21903	,
	34416	,
	27985	,
	109385	,
	101296	,
	28102	,
	109972	,
	1181	,
	101691	,
	307093	,
	312520	,
	933049	,
	31879	,
	18111	,
	933354	,
	32678	,
	21350	,
	107856	,
	23468	,
	20613	,
	21146	,
	933157	,
	26418	,
	25962	,
	29528	,
	29529	,
	29529	,
	25951	,
	22467	,
	24477	,
	932218	,
	22956	,
	22172	,
	109975	,
	28521	,
	28520	,
	27050	,
	103845	,
	16811	,
	33833	,
	20600	,
	8884	,
	19780	,
	33538	,
	33500	,
	21912	,
	109166	,
	1993	,
	1993	,
	29207	,
	19898	,
	19224	,
	311812	,
	933504	,
	933493	,
	933765	,
	933765	,
	33326	,
	933371	,
	24435	,
	110603	,
	23808	,
	26041	,
	29191	,
	23792	,
	23801	,
	27666	,
	19802	,
	4124	,
	933494	,
	23599	,
	7803	,
	23565	,
	933830	,
	933803	,
	933817	,
	27742	,
	29012	,
	23678	,
	28435	,
	23668	,
	23671	,
	27487	,
	306011	,
	26642	,
	310085	,
	933608	,
	310095	,
	314226	,
	304723	,
	19209	,
	109132	,
	23385	,
	23385	,
	29462	,
	313866	,
	32562	,
	313879	,
	313889	,
	17039	,
	27583	,
	25373	,
	25373	,
	17304	,
	32568	,
	27868	,
	27017	,
	20924	,
	14902	,
	28167	,
	20605	,
	931842	,
	24043	,
	25959	,
	25959	,
	101780	,
	101865	,
	101878	,
	101795	,
	101796	,
	101899	,
	101714	,
	101724	,
	101750	,
	933142	,
	9157	,
	15026	,
	316269	,
	305853	,
	31754	,
	31751	,
	933339	,
	31795	,
	931709	,
	21979	,
	21979	,
	9237	,
	319272	,
	101296	,
	110656	,
	28097	,
	33415	,
	30263	,
	317858	,
	100435	,
	306857	,
	110685	,
	110685	,
	9951	,
	102108	,
	933354	,
	20613	,
	7725	,
	109837	,
	25225	,
	27049	,
	33833	,
	23489	,
	21111	,
	21912	,
	12460	,
	304617	,
	22607	,
	931207	,
	110857	,
	318785	,
	108992	,
	32251	,
	24250	,
	7447	,
	33232	,
	27640	,
	933822	,
	23815	,
	27627	,
	29191	,
	110179	,
	313509	,
	2790	,
	34171	,
	27742	,
	23396	,
	310085	,
	303905	,
	303905	,
	303905	,
	303905	,
	310099	,
	313867	,
	310086	,
	28374	,
	314206	,
	313889	,
	27871	,
	27871	,
	101164	,
	110027	,
	110027	,
	17358	,
	17358	,
	17358	,
	101715	,
	101798	,
	21813	,
	316269	,
	21121	,
	25060	,
	311383	,
	109972	,
	317858	,
	306857	,
	21943	,
	931206	,
	933354	,
	7722	,
	104037	,
	20658	,
	25957	,
	109166	,
	1993	,
	108941	,
	110175	,
	933581	,
	110603	,
	314254	,
	313525	,
	313929	,
	23806	,
	23677	,
	958	,
	26655	,
	19185	,
	4838	,
	23959	,
	109222	,
	101496	,
	37209	,
	100059	,
	21813	,
	31754	,
	4079	,
	25162	,
	315122	,
	110685	,
	22172	,
	16980	,
	26416	,
	8884	,
	105798	,
	25953	,
	315653	,
	83	,
	310399	,
	7421	,
	27627	,
	33256	,
	313511	,
	933817	,
	310082	,
	306011	,
	4386	,
	303561	,
	314211	,
	109191	,
	25887	,
	17304	,
	31820	,
	25959	,
	25725	,
	31288	,
	25040	,
	33410	,
	21264	,
	23473	,
	28994	,
	25957	,
	931207	,
	27393	,
	29012	,
	23257	,
	4838	,
	17137	,
	932897	,
	109222	,
	316975	,
	26139	,
	26139	,
	20605	,
	20642	,
	23465	,
	28102	,
	105943	,
	110391	,
	21087	,
	932230	,
	933493	,
	23788	,
	313553	,
	313515	,
	23599	,
	4386	,
	313866	,
	31820	,
	20399	,
	100079	,
	26139	,
	301934	,
	932042	,
	104024	,
	9237	,
	33415	,
	33410	,
	3566	,
	21263	,
	28254	,
	7793	,
	100961	,
	310082	,
	18792	,
	306006	,
	21622	,
	104024	,
	319272	,
	12460	,
	83	,
	7447	,
	313503	,
	933825	,
	314225	,
	958	,
	201641	,
	33410	,
	318990	,
	307337	,
	9951	,
	23808	,
	17008	,
	311230	,
	308137	,
	25959	,
	931206	,
	18737	,
	103319	,
	21933	,
	100059	,
	33415	,
	9586	,
	931207	,
	17304	,
	304860	,
	20837	,
	248	,
	314226	,
	306132	,
	304723	,
	8565	,
	307337	,
	100052	,
	311146	,
	310389	,
	933354	,
	104037	,
	16850	,
	306229	,
	313861	,
	4839	,
	307337	,
	104037	,
	104037	,
	313935	,
	310099	,
	313867	,
	20642	,
	315263	,
	24419	,
	19822	,
	27833	,
	37991	,
	100435	,
	306130	,
	7447	,
	313510	,
	103051	,
	20642	,
	101038	,
	103548	,
	29769	,
	21903	,
	37991	,
	18111	,
	29770	,
	313508	,
	305898	,
	310095	,
	314206	,
	19698	,
	3566	,
	37991	,
	315660	,
	4839	,
	17039	,
	110685	,
	311146	,
	303589	,
	315931	,
	107455	,
	103312	,
	956	,
	300685	,
	313509	,
	21622	,
	20399	,
	8404	,
	100435	,
	311807	,
	83	,
	310391	,
	304860	,
	100052	,
	19822	,
	311893	,
	310148	,
	304453	,
	4839	,
	304189	,
	311232	,
	7421	,
	104024	,
	15819	,
	19698	,
	430	,
	17137	,
	100434	,
	101296	,
	16980	,
	21264	,
	313879	,
	19698	,
	108814	,
	318156	,
	37993	,
	933142	,
	314213	,
	306857	,
	19698	,
	4838	,
	932152	,
	104024	,
	110391	,
	303343	,
	37993	,
	103599	,
	313889	,
	311146	,
	311183	,
	313581	,
	200416	,
	19125	,
	3566	,
	18681	,
	6649	,
	29274	,
	107	,
	318934	,
	100059	,
	311146	,
	303343	,
	303343	,
	25040	,
	932152	,
	37993	,
	103051	,
	2912	,
	311076	,
	37993	,
	311242	,
	103077	,
	29274	,
	7128	,
	101439	,
	311807	,
	29274	,
	107	,
	2502	
)
--and pv.codproduto = 318467
order by codproduto

--select 'wget https://sistema.mgpapelaria.com.br/MGLara/estoque/calcula-custo-medio/' || codestoquemes from tblestoquemovimento where observacoes = 'Zeramento automatico dos produtos negativos do estoque fiscal de dezembro de 2019.' order by codestoquemes